<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 5 Week 4- What is a Genetic Variant? | 04-Week4.Rmd</title>
  <meta name="description" content=" 5 Week 4- What is a Genetic Variant? | 04-Week4.Rmd" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content=" 5 Week 4- What is a Genetic Variant? | 04-Week4.Rmd" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 5 Week 4- What is a Genetic Variant? | 04-Week4.Rmd" />
  
  
  

<meta name="author" content="M. Armstrong" />


<meta name="date" content="2025-04-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-3--working-with-files-part-2.html"/>
<link rel="next" href="week-5--welcome-to-the-r-environment.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Genomics in Natural Populations</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro to Genomics in Natural Populations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#meet-your-instructors"><i class="fa fa-check"></i><b>1.2</b> Meet your instructors!</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#getting-your-farm-account-set-up-class-specific"><i class="fa fa-check"></i><b>1.3</b> Getting your Farm Account set up (class specific)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1--welcome.html"><a href="week-1--welcome.html"><i class="fa fa-check"></i><b>2</b> Week 1- Welcome!</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1--welcome.html"><a href="week-1--welcome.html#main-objectives"><i class="fa fa-check"></i><b>2.1</b> Main Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="week-1--welcome.html"><a href="week-1--welcome.html#how-to-access-the-shell-via-farm-ondemand"><i class="fa fa-check"></i><b>2.2</b> How to access the shell via Farm OnDemand</a></li>
<li class="chapter" data-level="2.3" data-path="week-1--welcome.html"><a href="week-1--welcome.html#navigating-your-file-system"><i class="fa fa-check"></i><b>2.3</b> Navigating your file system</a></li>
<li class="chapter" data-level="2.4" data-path="week-1--welcome.html"><a href="week-1--welcome.html#shortcut-tab-completion"><i class="fa fa-check"></i><b>2.4</b> Shortcut: Tab Completion</a></li>
<li class="chapter" data-level="2.5" data-path="week-1--welcome.html"><a href="week-1--welcome.html#creating-our-own-directories"><i class="fa fa-check"></i><b>2.5</b> Creating our own directories</a></li>
<li class="chapter" data-level="2.6" data-path="week-1--welcome.html"><a href="week-1--welcome.html#full-vs-relative-paths"><i class="fa fa-check"></i><b>2.6</b> Full vs Relative Paths</a></li>
<li class="chapter" data-level="2.7" data-path="week-1--welcome.html"><a href="week-1--welcome.html#examining-the-contents-of-other-directories"><i class="fa fa-check"></i><b>2.7</b> Examining the contents of other directories</a></li>
<li class="chapter" data-level="2.8" data-path="week-1--welcome.html"><a href="week-1--welcome.html#group-work-activity--treasure-hunt"><i class="fa fa-check"></i><b>2.8</b> Group Work Activity- Treasure Hunt!</a></li>
<li class="chapter" data-level="2.9" data-path="week-1--welcome.html"><a href="week-1--welcome.html#key-points"><i class="fa fa-check"></i><b>2.9</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html"><i class="fa fa-check"></i><b>3</b> Week 2- Working with Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#main-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Main Objectives:</a></li>
<li class="chapter" data-level="3.2" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#navigational-shortcuts"><i class="fa fa-check"></i><b>3.2</b> Navigational shortcuts</a></li>
<li class="chapter" data-level="3.3" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#sequencing-pipeline"><i class="fa fa-check"></i><b>3.3</b> Sequencing Pipeline</a></li>
<li class="chapter" data-level="3.4" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#details-on-the-fastq-format"><i class="fa fa-check"></i><b>3.4</b> Details on the FASTQ format</a></li>
<li class="chapter" data-level="3.5" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#our-data-set-fastq-files"><i class="fa fa-check"></i><b>3.5</b> Our data set: FASTQ files</a></li>
<li class="chapter" data-level="3.6" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#wildcards"><i class="fa fa-check"></i><b>3.6</b> Wildcards</a></li>
<li class="chapter" data-level="3.7" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#command-history"><i class="fa fa-check"></i><b>3.7</b> Command History</a></li>
<li class="chapter" data-level="3.8" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#examining-files"><i class="fa fa-check"></i><b>3.8</b> Examining Files</a></li>
<li class="chapter" data-level="3.9" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#group-work-activity--examining-a-fastq-file"><i class="fa fa-check"></i><b>3.9</b> Group Work Activity- Examining a Fastq File</a></li>
<li class="chapter" data-level="3.10" data-path="week-2--working-with-files.html"><a href="week-2--working-with-files.html#key-points-1"><i class="fa fa-check"></i><b>3.10</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html"><i class="fa fa-check"></i><b>4</b> Week 3- Working with Files Part 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#main-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Main Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#creating-moving-copying-and-removing"><i class="fa fa-check"></i><b>4.2</b> Creating, moving, copying, and removing</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#copying-files"><i class="fa fa-check"></i><b>4.2.1</b> Copying Files</a></li>
<li class="chapter" data-level="4.2.2" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#creating-directories"><i class="fa fa-check"></i><b>4.2.2</b> Creating Directories</a></li>
<li class="chapter" data-level="4.2.3" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#moving-renaming"><i class="fa fa-check"></i><b>4.2.3</b> Moving / Renaming</a></li>
<li class="chapter" data-level="4.2.4" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#file-permissions"><i class="fa fa-check"></i><b>4.2.4</b> File Permissions</a></li>
<li class="chapter" data-level="4.2.5" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#removing"><i class="fa fa-check"></i><b>4.2.5</b> Removing</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#searching-files"><i class="fa fa-check"></i><b>4.3</b> Searching files</a></li>
<li class="chapter" data-level="4.4" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#redirecting-output"><i class="fa fa-check"></i><b>4.4</b> Redirecting output</a></li>
<li class="chapter" data-level="4.5" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#file-extensions"><i class="fa fa-check"></i><b>4.5</b> File extensions</a></li>
<li class="chapter" data-level="4.6" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#writing-for-loops"><i class="fa fa-check"></i><b>4.6</b> Writing for loops</a></li>
<li class="chapter" data-level="4.7" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#using-basename-in-for-loops"><i class="fa fa-check"></i><b>4.7</b> Using Basename in for loops</a></li>
<li class="chapter" data-level="4.8" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#writing-scripts-and-working-with-data"><i class="fa fa-check"></i><b>4.8</b> Writing Scripts and Working with Data</a></li>
<li class="chapter" data-level="4.9" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#writing-scripts-bash"><i class="fa fa-check"></i><b>4.9</b> Writing scripts: Bash</a></li>
<li class="chapter" data-level="4.10" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#writing-scripts-slurm"><i class="fa fa-check"></i><b>4.10</b> Writing scripts: Slurm</a></li>
<li class="chapter" data-level="4.11" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#group-work-activity--writing-your-own-script"><i class="fa fa-check"></i><b>4.11</b> Group Work Activity- Writing your own script</a></li>
<li class="chapter" data-level="4.12" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#key-points-2"><i class="fa fa-check"></i><b>4.12</b> Key Points</a></li>
<li class="chapter" data-level="4.13" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#additional-information"><i class="fa fa-check"></i><b>4.13</b> Additional Information</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#uploading-and-downloading-data-to-your-virtual-machine-with-scp---unix"><i class="fa fa-check"></i><b>4.13.1</b> Uploading and Downloading Data to your Virtual Machine with scp - UNIX</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#more-ways-to-work-with-files"><i class="fa fa-check"></i><b>4.14</b> More ways to work with files</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="week-3--working-with-files-part-2.html"><a href="week-3--working-with-files-part-2.html#awk"><i class="fa fa-check"></i><b>4.14.1</b> Awk</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html"><i class="fa fa-check"></i><b>5</b> Week 4- What is a Genetic Variant?</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#main-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Main Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-1-download-data"><i class="fa fa-check"></i><b>5.2</b> Step 1: Download data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#getting-data-from-the-cloud"><i class="fa fa-check"></i><b>5.2.1</b> Getting data from the cloud</a></li>
<li class="chapter" data-level="5.2.2" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#tools-for-todays-class"><i class="fa fa-check"></i><b>5.2.2</b> tools for today’s class</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-1.2-raw-read-quality-control"><i class="fa fa-check"></i><b>5.3</b> Step 1.2: Raw read quality control</a></li>
<li class="chapter" data-level="5.4" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-2-trimming-to-remove-adapters"><i class="fa fa-check"></i><b>5.4</b> Step 2: Trimming to remove adapters</a></li>
<li class="chapter" data-level="5.5" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-3-building-an-index-of-our-genome"><i class="fa fa-check"></i><b>5.5</b> Step 3: Building an index of our genome</a></li>
<li class="chapter" data-level="5.6" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-4-map-reads-to-the-genome"><i class="fa fa-check"></i><b>5.6</b> Step 4: Map reads to the genome</a></li>
<li class="chapter" data-level="5.7" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-5-sam-to-bam-file-conversion"><i class="fa fa-check"></i><b>5.7</b> Step 5: sam to bam file conversion</a></li>
<li class="chapter" data-level="5.8" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#step-6-genotype-likelihoods"><i class="fa fa-check"></i><b>5.8</b> Step 6: Genotype likelihoods</a></li>
<li class="chapter" data-level="5.9" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#group-work-activity--calling-variants-at-a-larger-scale"><i class="fa fa-check"></i><b>5.9</b> Group Work Activity- Calling Variants at a Larger Scale</a></li>
<li class="chapter" data-level="5.10" data-path="week-4--what-is-a-genetic-variant.html"><a href="week-4--what-is-a-genetic-variant.html#key-points-3"><i class="fa fa-check"></i><b>5.10</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html"><i class="fa fa-check"></i><b>6</b> Week 5- Welcome to the R environment!</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#main-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Main Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#orientation-to-r"><i class="fa fa-check"></i><b>6.2</b> Orientation to R</a></li>
<li class="chapter" data-level="6.3" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#manipulating-a-vector-object"><i class="fa fa-check"></i><b>6.3</b> Manipulating a vector object</a></li>
<li class="chapter" data-level="6.4" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#operations-act-on-each-element-of-a-vector"><i class="fa fa-check"></i><b>6.4</b> Operations act on each element of a vector:</a></li>
<li class="chapter" data-level="6.5" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#operations-can-also-work-with-two-vectors"><i class="fa fa-check"></i><b>6.5</b> Operations can also work with two vectors:</a></li>
<li class="chapter" data-level="6.6" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#a-few-tips-below-for-working-with-objects"><i class="fa fa-check"></i><b>6.6</b> A few tips below for working with objects:</a></li>
<li class="chapter" data-level="6.7" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#characterizing-a-dataframe"><i class="fa fa-check"></i><b>6.7</b> Characterizing a dataframe</a></li>
<li class="chapter" data-level="6.8" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#how-to-access-parts-of-the-data"><i class="fa fa-check"></i><b>6.8</b> How to access parts of the data:</a></li>
<li class="chapter" data-level="6.9" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#data-manipulation"><i class="fa fa-check"></i><b>6.9</b> Data Manipulation</a></li>
<li class="chapter" data-level="6.10" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#practice-exploring-a-dataframe"><i class="fa fa-check"></i><b>6.10</b> Practice exploring a dataframe</a></li>
<li class="chapter" data-level="6.11" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#subsetting-datasets-logicals"><i class="fa fa-check"></i><b>6.11</b> Subsetting datasets &amp; logicals</a></li>
<li class="chapter" data-level="6.12" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#group-work-activity-practice-exploring-data-in-r"><i class="fa fa-check"></i><b>6.12</b> Group Work Activity: Practice Exploring Data in R</a></li>
<li class="chapter" data-level="6.13" data-path="week-5--welcome-to-the-r-environment.html"><a href="week-5--welcome-to-the-r-environment.html#key-points-4"><i class="fa fa-check"></i><b>6.13</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html"><i class="fa fa-check"></i><b>7</b> Week 6- Plotting in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#main-objectives-5"><i class="fa fa-check"></i><b>7.1</b> Main Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#plotting-in-base-r"><i class="fa fa-check"></i><b>7.2</b> Plotting in Base R</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#scatterplots"><i class="fa fa-check"></i><b>7.2.1</b> Scatterplots</a></li>
<li class="chapter" data-level="7.2.2" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#histograms"><i class="fa fa-check"></i><b>7.2.2</b> Histograms</a></li>
<li class="chapter" data-level="7.2.3" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#class-exercise-1"><i class="fa fa-check"></i><b>7.2.3</b> Class Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>7.3</b> Plotting with ggplot2</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#class-exercise-2-1"><i class="fa fa-check"></i><b>7.3.1</b> Class Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#for-loops-and-the-apply-family-of-functions"><i class="fa fa-check"></i><b>7.4</b> For loops and the apply family of functions</a></li>
<li class="chapter" data-level="7.5" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#group-work-activity-palmer-penguins"><i class="fa fa-check"></i><b>7.5</b> Group Work Activity: Palmer Penguins!</a></li>
<li class="chapter" data-level="7.6" data-path="week-6--plotting-in-r.html"><a href="week-6--plotting-in-r.html#key-points-5"><i class="fa fa-check"></i><b>7.6</b> Key Points</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">04-Week4.Rmd</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-4--what-is-a-genetic-variant" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number"> 5</span> Week 4- What is a Genetic Variant?<a href="week-4--what-is-a-genetic-variant.html#week-4--what-is-a-genetic-variant" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You’ll find the lecture discussing the definition and identification of
genetic variation here (via slideshow here: <a href="./figs/W4%20Mapping.pdf">Week 4
Slides</a>)</p>
<div id="main-objectives-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Main Objectives<a href="week-4--what-is-a-genetic-variant.html#main-objectives-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Be able to define what a genetic variant is</li>
<li>Understand the pipeline for identifying genetic variants</li>
<li>Understand the difference between SAM and BAM file formats and their
use</li>
<li>Learn how to call a genotype and quantify genotype likelihoods</li>
</ul>
</div>
<div id="step-1-download-data" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Step 1: Download data<a href="week-4--what-is-a-genetic-variant.html#step-1-download-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below we’ll show you some commands to download data onto your instance,
or to move data between your computer and the cloud.</p>
<div id="getting-data-from-the-cloud" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Getting data from the cloud<a href="week-4--what-is-a-genetic-variant.html#getting-data-from-the-cloud" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two programs that will download data from a remote server to
your local (or remote) machine: <code>wget</code> and <code>curl</code>. They were designed to
do slightly different tasks by default, so you’ll need to give the
programs somewhat different options to get the same behaviour, but they
are mostly interchangeable.</p>
<ul>
<li><p><code>wget</code> is short for “world wide web get”, and it’s basic function is
to <em>download</em> web pages or data at a web address.</p></li>
<li><p><code>cURL</code> is a pun, it is supposed to be read as “see URL”, so its
basic function is to <em>display</em> webpages or data at a web address.</p></li>
</ul>
<p>Which one you need to use mostly depends on your operating system, as
most computers will only have one or the other installed by default.</p>
<p>Before we can start our download, we need to know whether we’re using
<code>curl</code> or <code>wget</code>. To see which program you have, type:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="week-4--what-is-a-genetic-variant.html#cb1-1" tabindex="-1"></a>$ which curl</span>
<span id="cb1-2"><a href="week-4--what-is-a-genetic-variant.html#cb1-2" tabindex="-1"></a>$ which wget</span></code></pre></div>
<p><code>which</code> is a BASH program that looks through everything you have
installed, and tells you what folder it is installed to. If it can’t
find the program you asked for, it returns nothing, i.e. gives you no
results.</p>
<p>On Mac OSX, you’ll likely get the following output:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb2-1"><a href="week-4--what-is-a-genetic-variant.html#cb2-1" tabindex="-1"></a>$ which wget</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb3-1"><a href="week-4--what-is-a-genetic-variant.html#cb3-1" tabindex="-1"></a>$ /usr/bin/wget</span></code></pre></div>
<p>We will be using wget to retrieve data from the class github, but if you
want more practice with this tool there is an additional tutorial below:</p>
<blockquote>
<h3 id="ensembl-data-retrieving-exercise" class="hasAnchor">Ensembl data retrieving exercise:<a href="week-4--what-is-a-genetic-variant.html#ensembl-data-retrieving-exercise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="week-4--what-is-a-genetic-variant.html#cb4-1" tabindex="-1"></a>$ cd</span>
<span id="cb4-2"><a href="week-4--what-is-a-genetic-variant.html#cb4-2" tabindex="-1"></a>$ wget ftp://ftp.ensemblgenomes.org/pub/release-37/bacteria/species_EnsemblBacteria.txt</span></code></pre></div>
<p>Let’s see if the file from ensembl downloaded</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb5-1"><a href="week-4--what-is-a-genetic-variant.html#cb5-1" tabindex="-1"></a>ls species_EnsemblBacteria.txt</span></code></pre></div>
<p>It did! Woo!</p>
</blockquote>
<p>Download the data from the IntroGenomics_Data Week 4 repository on
github in your individual directory. Make sure you are there first
before you do the wget step!</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="week-4--what-is-a-genetic-variant.html#cb6-1" tabindex="-1"></a>cd /navigate/to/your/directory</span>
<span id="cb6-2"><a href="week-4--what-is-a-genetic-variant.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="week-4--what-is-a-genetic-variant.html#cb6-3" tabindex="-1"></a>wget https://raw.githubusercontent.com/mlarmstrong/IntroGenomics_Data/main/week4.zip</span></code></pre></div>
<p>And then unzip week4 so we can work with the data inside:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb7-1"><a href="week-4--what-is-a-genetic-variant.html#cb7-1" tabindex="-1"></a>unzip week4.zip</span></code></pre></div>
</div>
<div id="tools-for-todays-class" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> tools for today’s class<a href="week-4--what-is-a-genetic-variant.html#tools-for-todays-class" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are the programs we will be using today:</p>
<ul>
<li>fastqc: used to view the quality of the read files</li>
<li>samtools: allows us to filter and view our mapped data</li>
<li>bowtie2: to map our reads to the reference genome</li>
<li>cutadapt: will trim adaptor sequences from the reads</li>
<li>angsd: used to find variants in our data</li>
</ul>
<p>To load these tools navigate to your directory and type the following
code:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb8-1"><a href="week-4--what-is-a-genetic-variant.html#cb8-1" tabindex="-1"></a>module load fastqc</span></code></pre></div>
<p>You should get something on your screen that looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb9-1"><a href="week-4--what-is-a-genetic-variant.html#cb9-1" tabindex="-1"></a>madarm11@farm:/group/rbaygrp/eve198-genomics/mlarmstrong$ module load fastqc</span>
<span id="cb9-2"><a href="week-4--what-is-a-genetic-variant.html#cb9-2" tabindex="-1"></a>Loading openjdk/17.0.11_9</span>
<span id="cb9-3"><a href="week-4--what-is-a-genetic-variant.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="week-4--what-is-a-genetic-variant.html#cb9-4" tabindex="-1"></a>Loading fastqc/0.12.1</span>
<span id="cb9-5"><a href="week-4--what-is-a-genetic-variant.html#cb9-5" tabindex="-1"></a>  Loading requirement: openjdk/17.0.11_9</span></code></pre></div>
<p>This will load our module! Check to see that it loaded and what version
you are working with using this command:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb10-1"><a href="week-4--what-is-a-genetic-variant.html#cb10-1" tabindex="-1"></a>fastqc -v</span></code></pre></div>
<p>This tells us that we have fastqc loaded and we are using version
0.12.1. This is important information to report in papers too when you
discuss what genomics methods you’ve used. Repeat these steps for all
five packages! All of the package names are the same except for
cutadapt. Do load this and check the version control type:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb11-1"><a href="week-4--what-is-a-genetic-variant.html#cb11-1" tabindex="-1"></a>module load py-cutadapt</span>
<span id="cb11-2"><a href="week-4--what-is-a-genetic-variant.html#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="week-4--what-is-a-genetic-variant.html#cb11-3" tabindex="-1"></a>cutadapt -v</span></code></pre></div>
<p>Now we’re ready to get going. The first thing we’ll do is have a look at
our data and directories to make sure we know where everything is. This
is the general pipeline of what we will be doing today: <img src="figs/pipeline_variants.png" alt="Finding Variants Pipeline" /></p>
<p>We have already done step 1! Change directories so that you are inside
the week4 directory inside your individual directory. If you <code>ls</code> into
this directory you should see 6 files with a <code>.fastq.gz</code> extension and 1
tiny genome file with a <code>.fna.gz</code> extension.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb12-1"><a href="week-4--what-is-a-genetic-variant.html#cb12-1" tabindex="-1"></a>madarm11@farm:/group/rbaygrp/eve198-genomics/mlarmstrong/week4$ ls</span>
<span id="cb12-2"><a href="week-4--what-is-a-genetic-variant.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="week-4--what-is-a-genetic-variant.html#cb12-3" tabindex="-1"></a>Ppar_tinygenome.fna.gz    SRR6805881.tiny.fastq.gz  SRR6805883.tiny.fastq.gz  SRR6805885.tiny.fastq.gz</span>
<span id="cb12-4"><a href="week-4--what-is-a-genetic-variant.html#cb12-4" tabindex="-1"></a>SRR6805880.tiny.fastq.gz  SRR6805882.tiny.fastq.gz  SRR6805884.tiny.fastq.gz</span></code></pre></div>
</div>
</div>
<div id="step-1.2-raw-read-quality-control" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Step 1.2: Raw read quality control<a href="week-4--what-is-a-genetic-variant.html#step-1.2-raw-read-quality-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next let’s use the program fastqc to check the quality of our data
files:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb13-1"><a href="week-4--what-is-a-genetic-variant.html#cb13-1" tabindex="-1"></a>$ fastqc SRR6805880.tiny.fastq.gz</span></code></pre></div>
<ul>
<li>Readout should say:
<ul>
<li>Started analysis for SRR6805880.tiny.fastq.gz</li>
<li>Analysis complete for SRR6805880.tiny.fastq.gz</li>
</ul></li>
</ul>
<p>Let’s look to see that it worked</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb14-1"><a href="week-4--what-is-a-genetic-variant.html#cb14-1" tabindex="-1"></a>$ ls</span>
<span id="cb14-2"><a href="week-4--what-is-a-genetic-variant.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="week-4--what-is-a-genetic-variant.html#cb14-3" tabindex="-1"></a>Ppar_tinygenome.fna.gz       SRR6805880.tiny_fastqc.zip  SRR6805883.tiny.fastq.gz</span>
<span id="cb14-4"><a href="week-4--what-is-a-genetic-variant.html#cb14-4" tabindex="-1"></a>SRR6805880.tiny.fastq.gz     SRR6805881.tiny.fastq.gz    SRR6805884.tiny.fastq.gz</span>
<span id="cb14-5"><a href="week-4--what-is-a-genetic-variant.html#cb14-5" tabindex="-1"></a>SRR6805880.tiny_fastqc.html  SRR6805882.tiny.fastq.gz    SRR6805885.tiny.fastq.gz</span></code></pre></div>
<p>Looks good! Fastqc generated two outputs for us, a <code>.html</code> and a <code>.zip</code>
directory</p>
<p>Let’s run fastqc on the remaining files, and then we’ll take a look at
the output. You may have noticed fastqc just used the same file name to
produce our output with different extensions. We can take advantage of
that by running fastqc on all our datafiles with the wildcard <code>*</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb15-1"><a href="week-4--what-is-a-genetic-variant.html#cb15-1" tabindex="-1"></a>$ fastqc SRR680588*</span></code></pre></div>
<p><img src="figs/fastqc-output.png" alt="What you should see on your screen!" /> You may
initially get an error message because fastqc doesn’t see the .fastq
file extension on some of our files. It simply skips these and moves on
the the next file.</p>
<p>To view the output of fastqc you can access the html files for each
sample. To make one big html file with all of our samples we can run
multiqc. More information on this tool here:
<a href="https://github.com/MultiQC/MultiQC" class="uri">https://github.com/MultiQC/MultiQC</a>. For now we will just be looking at
each html individually.</p>
<blockquote>
<h3 id="class-exercise-1-looking-at-your-fastqc.html-files" class="hasAnchor">Class Exercise 1: looking at your fastqc.html files!<a href="week-4--what-is-a-genetic-variant.html#class-exercise-1-looking-at-your-fastqc.html-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Navigate to <code>home/group/rbaygrp/eve198-genomics/yourdirectory/week4</code>
to find your html files you created with fastqc. Try clicking on
individual html files too for information specific to each fastq
sample. These will look more similar to what I showed in the
mini-lecture at the beginning of class. <img src="figs/html_nav.png" alt="Click the yellow “home” folder and navigate to fastqc.html files" /></p>
</blockquote>
</div>
<div id="step-2-trimming-to-remove-adapters" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Step 2: Trimming to remove adapters<a href="week-4--what-is-a-genetic-variant.html#step-2-trimming-to-remove-adapters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many programs to trim sequence files. Cutadapt is relatively
easy to run with the code below, once we have identified our adaptor
sequence and takes the general form below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb16-1"><a href="week-4--what-is-a-genetic-variant.html#cb16-1" tabindex="-1"></a>$ cutadapt -g SEQUENCETOTRIM -o name_of_input_file name_of_output_file </span></code></pre></div>
<p>Let’s do this on one of our files to test it out.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb17-1"><a href="week-4--what-is-a-genetic-variant.html#cb17-1" tabindex="-1"></a>cutadapt -g TGCAG SRR6805880.tiny.fastq.gz -o SRR6805880.tiny_trimmed.fastq.gz </span></code></pre></div>
<p>This works for a single file, but if we want to do it for all our read
files we need to either do them all individually (slow and error prone)
or use a for loop.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb18-1"><a href="week-4--what-is-a-genetic-variant.html#cb18-1" tabindex="-1"></a>for filename in *.tiny.fastq.gz</span>
<span id="cb18-2"><a href="week-4--what-is-a-genetic-variant.html#cb18-2" tabindex="-1"></a>do</span>
<span id="cb18-3"><a href="week-4--what-is-a-genetic-variant.html#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="week-4--what-is-a-genetic-variant.html#cb18-4" tabindex="-1"></a>  base=$(basename $filename .tiny.fastq.gz)</span>
<span id="cb18-5"><a href="week-4--what-is-a-genetic-variant.html#cb18-5" tabindex="-1"></a>  echo ${base}</span>
<span id="cb18-6"><a href="week-4--what-is-a-genetic-variant.html#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="week-4--what-is-a-genetic-variant.html#cb18-7" tabindex="-1"></a>  cutadapt -g TGCAG ${base}.tiny.fastq.gz -o ${base}.tiny_trimmed.fastq.gz </span>
<span id="cb18-8"><a href="week-4--what-is-a-genetic-variant.html#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="week-4--what-is-a-genetic-variant.html#cb18-9" tabindex="-1"></a>done</span></code></pre></div>
<p>Yay! You should see a little report for each of these files that showing
how many reads were trimmed and some other info (how long are the reads,
etc)</p>
<p>You can check if the trimmed files are there with:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb19-1"><a href="week-4--what-is-a-genetic-variant.html#cb19-1" tabindex="-1"></a>ls *trimmed*</span></code></pre></div>
<blockquote>
<h3 id="class-exercise-2" class="hasAnchor">Class Exercise 2<a href="week-4--what-is-a-genetic-variant.html#class-exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Run fastqc on our .trimmed reads and compare the html with the
.untrimmed files. What main difference do you see between them?</p>
</blockquote>
<p>Our reads are now ready to be mapped to the genome!</p>
</div>
<div id="step-3-building-an-index-of-our-genome" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Step 3: Building an index of our genome<a href="week-4--what-is-a-genetic-variant.html#step-3-building-an-index-of-our-genome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we have to index our genome. We’ll do that with the bowtie2-build
command. This will generate a lot of files that describe different
aspects of our genome</p>
<p>We give bowtie2-build two things, the name of our genome, and a general
name to label the output files. I always keep the name of the output
files the same as the original genome file (without the .fna.gz
extension) to avoid confusion.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb20-1"><a href="week-4--what-is-a-genetic-variant.html#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="week-4--what-is-a-genetic-variant.html#cb20-2" tabindex="-1"></a>bowtie2-build Ppar_tinygenome.fna.gz Ppar_tinygenome</span></code></pre></div>
<p>This should produce several output files with extensions including: .bt2
and rev.1.bt2 etc (six files in total)</p>
</div>
<div id="step-4-map-reads-to-the-genome" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Step 4: Map reads to the genome<a href="week-4--what-is-a-genetic-variant.html#step-4-map-reads-to-the-genome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s map those reads using a for loop</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb21-1"><a href="week-4--what-is-a-genetic-variant.html#cb21-1" tabindex="-1"></a>for filename in *.tiny_trimmed.fastq.gz</span>
<span id="cb21-2"><a href="week-4--what-is-a-genetic-variant.html#cb21-2" tabindex="-1"></a>do</span>
<span id="cb21-3"><a href="week-4--what-is-a-genetic-variant.html#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="week-4--what-is-a-genetic-variant.html#cb21-4" tabindex="-1"></a>  base=$(basename $filename .tiny_trimmed.fastq.gz)</span>
<span id="cb21-5"><a href="week-4--what-is-a-genetic-variant.html#cb21-5" tabindex="-1"></a>  echo ${base}</span>
<span id="cb21-6"><a href="week-4--what-is-a-genetic-variant.html#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="week-4--what-is-a-genetic-variant.html#cb21-7" tabindex="-1"></a>  bowtie2 -x Ppar_tinygenome -U ${base}.tiny_trimmed.fastq.gz -S ${base}.sam</span>
<span id="cb21-8"><a href="week-4--what-is-a-genetic-variant.html#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="week-4--what-is-a-genetic-variant.html#cb21-9" tabindex="-1"></a>done</span></code></pre></div>
<p>You should see a bunch of text telling you all about how well our reads
mapped to the genome. For this example we’re getting a low percentage
(20-30%) because of how the genome and reads were subset for this
exercise.</p>
<p>You’ll also notice that we have made a bunch of .sam files. THis stands
for Sequence Alignment Map file. Let’s use <code>less</code> to look at one of
these files using <code>less</code></p>
<blockquote>
<h3 id="class-exercise-3" class="hasAnchor">Class Exercise 3<a href="week-4--what-is-a-genetic-variant.html#class-exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s write a for loop to map the untrimmed files to the genome.
How do the alignments compare to the trimmed ones we just did as a
class?</p>
</blockquote>
</div>
<div id="step-5-sam-to-bam-file-conversion" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Step 5: sam to bam file conversion<a href="week-4--what-is-a-genetic-variant.html#step-5-sam-to-bam-file-conversion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next step is to convert our sam file to a bam (Binary Alignment Map
file). This gets our file ready to be read by angsd the program we’re
going to use to call SNPs.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb22-1"><a href="week-4--what-is-a-genetic-variant.html#cb22-1" tabindex="-1"></a>for filename in *.sam</span>
<span id="cb22-2"><a href="week-4--what-is-a-genetic-variant.html#cb22-2" tabindex="-1"></a>do</span>
<span id="cb22-3"><a href="week-4--what-is-a-genetic-variant.html#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="week-4--what-is-a-genetic-variant.html#cb22-4" tabindex="-1"></a>  base=$(basename $filename .sam)</span>
<span id="cb22-5"><a href="week-4--what-is-a-genetic-variant.html#cb22-5" tabindex="-1"></a>  echo ${base}</span>
<span id="cb22-6"><a href="week-4--what-is-a-genetic-variant.html#cb22-6" tabindex="-1"></a>  </span>
<span id="cb22-7"><a href="week-4--what-is-a-genetic-variant.html#cb22-7" tabindex="-1"></a>  samtools view -bhS ${base}.sam | samtools sort -o ${base}.bam</span>
<span id="cb22-8"><a href="week-4--what-is-a-genetic-variant.html#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="week-4--what-is-a-genetic-variant.html#cb22-9" tabindex="-1"></a>done</span></code></pre></div>
</div>
<div id="step-6-genotype-likelihoods" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Step 6: Genotype likelihoods<a href="week-4--what-is-a-genetic-variant.html#step-6-genotype-likelihoods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many ways and many programs that call genotypes. The program
that we will use calculates genotype likelihoods, which account for
uncertainty due to sequencing errors and/or mapping errors and is one of
several programs in the package ANGSD. The purpose of this class is not
to discuss which program is the “best”, but to teach you to use some
commonly used programs.</p>
<p>angsd needs a text file with the <code>.bam</code> file names listed. We can make
that by running the command below</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb23-1"><a href="week-4--what-is-a-genetic-variant.html#cb23-1" tabindex="-1"></a></span>
<span id="cb23-2"><a href="week-4--what-is-a-genetic-variant.html#cb23-2" tabindex="-1"></a>ls *.bam &gt; bam.filelist</span></code></pre></div>
<p>Look at the list:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb24-1"><a href="week-4--what-is-a-genetic-variant.html#cb24-1" tabindex="-1"></a>cat bam.filelist</span></code></pre></div>
<p>Run the following code to calculate genotype likelihoods</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb25-1"><a href="week-4--what-is-a-genetic-variant.html#cb25-1" tabindex="-1"></a></span>
<span id="cb25-2"><a href="week-4--what-is-a-genetic-variant.html#cb25-2" tabindex="-1"></a>angsd -bam bam.filelist -GL 1 -out genotype_likelihoods -doMaf 2 -SNP_pval 1e-2 -doMajorMinor 1</span></code></pre></div>
<p>This will generate two files, one with a .arg extension, this has a
record of the script we ran to generate the output, and a .maf file that
will give you the minor allele frequencies and is the main output file.
If you see these two files, Yay!! We did it!</p>
<p>We can change the parameters of the angsd genotype likelihoods command
by altering the values next to <code>-SNP_pval</code>. If we remove the <code>-SNP_pval</code>
command entirely we get ~72000 sites retained! Wow! That seems like a
lot given our ~20% mapping rate. If you instead increase the p-value
threshold to 1e-3 we find 3 SNPs.</p>
<p>To see what the other parameters do you can run the following:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb26-1"><a href="week-4--what-is-a-genetic-variant.html#cb26-1" tabindex="-1"></a>angsd -h</span></code></pre></div>
</div>
<div id="group-work-activity--calling-variants-at-a-larger-scale" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Group Work Activity- Calling Variants at a Larger Scale<a href="week-4--what-is-a-genetic-variant.html#group-work-activity--calling-variants-at-a-larger-scale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this exercise we ran everything in the same directory and you can
see that we generated quite a few files by the time we were done. Many
population genomic studies have data for hundreds of individuals and
running everything in the same directory gets confusing and messy.
However, having the data in a different directory from the output
complicates running things a little (you have to remember which
directory you’re in). Make a new directory inside your own week4
directory called <code>raw_data</code> and <code>mv</code> the raw data files (those that end
in fastq.gz, and the tinygenome) into it. Then move everything that we
generated into a folder called <code>old_outputs</code>.</p>
<p>Now you can write your own slurm script to call genetic variants. Use
the code above to help you process everything in one single script. Make
a directory for the <code>trimmed_reads</code> and <code>sam_bam</code> files each. Submit a
copy of your script for this activity on canvas under the ‘Assignments’
tab for ‘Week 4: Calling Variants’.</p>
</div>
<div id="key-points-3" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Key Points<a href="week-4--what-is-a-genetic-variant.html#key-points-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The general pipeline for identifying genetic variants first starts
with trimming adaptors from the sample reads, indexing the reference
genome, mapping the reads to the genome, converting the sam file to
a bam (binary) file and then calculating the genotype likelihoods.</li>
<li>There are many tools that are useful for calling genetic variants,
including samtools, bowtie2, cutadapt and</li>
<li>SAM and BAM files are similar, but BAM files are in a binary format
which makes it easier to process and call SNPs</li>
<li>ANGSD is a useful program for calculating genotype likelihoods and
accounts for uncertainty due to sequencing errors and/or mapping
errors</li>
</ul>
<details>
<summary>
<span style="color: orange;">Class Exercise Solutions</span>
</summary>
<p>
<blockquote>
<blockquote>
<h2 id="exercise-solutions" class="hasAnchor">Exercise: Solutions<a href="week-4--what-is-a-genetic-variant.html#exercise-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Exercise 1. just look at your html files! Exercise 2. We should no
longer see the red error flag for the per base sequence quality or
base pairs conten. code: fastqc *trimmed.fastq.gz Exercise 3: The
full genome and full read files should have a much higher mapping
rate (70-80%) &gt; than our subset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb27-1"><a href="week-4--what-is-a-genetic-variant.html#cb27-1" tabindex="-1"></a>for filename in *tiny.fastq.gz; do; base=$(basename $filename .tiny.fastq.gz); echo=${base}; bowtie2 -x Ppar_tinygenome.fna.gz -U ${base}.tiny.fastq.gz -S ${base}.nottrimmed.sam; done</span></code></pre></div>
</blockquote>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-3--working-with-files-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-5--welcome-to-the-r-environment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
